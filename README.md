
[![CI](https://github.com/klesarev/excel-pixel-drawer/actions/workflows/main-test.yml/badge.svg?branch=master)](https://github.com/klesarev/excel-pixel-drawer/actions/workflows/main-test.yml)

# Excel Pixel Drawer

![Альтернативный текст](pixel-heart.jpg "Excel Pixel Drawer")

## Описание
Простой скрипт, который позволяет рисовать пиксельную графику, используя excel в качестве полотна. Заливая цветом 
ячейки в документе, мы получаем на выходе картинку в формате - png. bmp, jpg.


## Как использовать?
### Пиксельное изображение из Excel
Например, чтобы получить пиксельную картинку из xls файла, создаем переменную и присваиваем ей результат 
вызова метода **_getPixelColors_**, в котором первым параметром указываем путь к файлу(_.xlsx_), 
а вторым - название листа, на котором хранится наш рисунок. 

> В методе **_renderImage_** вторым параметром можно указать свой размер пикселя (плитки). По умолчанию он равен 10. 
> Пример **_renderImage(res, 20)_** отрисует картинку с размером пикселя (плитки) 20px.

Затем переменную передаем в **_renderImage_**. Результат записываем с помощью **_writeImage_**, где первый параметр - 
результат вызова метода **_renderImage_**, а второй - путь к файлу.


```kotlin
    // получаем массив из xlsx файла - лист "editor"
    val res = getExcelPixels("D:/pix.xlsx","editor")

    // получаем отрендеренное изображение
    renderImage(res, file="D:/test.png", pixelSize = 2)
```

### Загрузить изображение в Excel
Чтобы загрузить изображение в Excel в виде пиксельной сетки вызываем метод **__getImagePixels__**, куда передаем путь
к файлу картинки. Затем, загружаем полученный массив пикселей в excel с помошью **__renderExcel__**, где первый аргумент
- результат функции getImagePixels, второй - название листа в файле xlsx, а третий аргумент - итоговый файл в формате 
xlsx. Если два последних аргумента можно не указывать, то по умолчанию лист будет называться __list__, а файл будет 
  сохранен под именем - __excel_from_image.xlsx__ в папке с проектом.

```kotlin
    // загружаем пиксели из файла картинки
    val pixels = getImagePixels("D:/test.png")
    
    // рендерим пиксели в Excel
    renderExcel(pixels,"list","D:/test.xlsx")
```



## История изменений

### Excel Pixel drawer 1.1
+ Функция отрисовки массива пикселей в Excel
+ Улучшена производительность
+ Исправлены ошибки

### Excel Pixel drawer 1.0.1
Добавлено несколько улучшений

+ Черно-белый фильтр для изображения
+ Свой размер плитки (пикселя)

### Excel Pixel drawer 1.0
Первый релиз. Базовый набор функций.
+ Поддерживается табличный формат xlsx.
+ Отрисовка изображения в формат - png



